{% extends "bases/dev_base.html" %}
{% load advanced_inputs %}
{% load static %}
{% load i18n %}

{% block top_submitted %}active{% endblock %}

{% block breadcrumb %}
    {{ block.super }}
    <li class="breadcrumb-item"><a
            href="{% url 'Repository:dev_submission_status' %}">{% trans "Submitted Packages" %}</a></li>
{% endblock %}

{% block page_content %}
    {% fende_widget widget_type='no-padding' location='start' id='status' title=_("Repository status") %}
        <table id="tab1" class="table table-striped table-bordered">
            <thead>
            <tr>
                <th><i class="fal mr-2 fa-tags"></i>{% trans "VNF Name" %}</th>
                <th><i class="fal mr-2 fa-exclamation-circle"></i>{% trans "Version" %}</th>
                <th><i class="fal mr-2 fa-eye"></i>Link</th>
                <th><i class="fal mr-2 fa-calendar"></i>{% trans "Submission Date" %}</th>
                <th><i class="fal mr-2 fa-comment"></i>{% trans "Decision" %}</th>
                <th><i class="fal fa-fw fa-tasks"></i>
                    {% trans "Actions" %}
                </th>
            </tr>
            </thead>
            <tbody>
            <!-- Populando a tabela com informações da tabela Requests -->
            {% for Request in vnf_list %}
                <tr>
                    <td>{{ Request.VNF_name }}</td>
                    <td>{{ Request.version }}</td>
                    <td>
                        {% if Request.link == 'Package Constructor' %}
                            <a class="btn btn-xs w-100 btn-info" href="{% url 'Repository:download' Request.request_id %}"><i
                                    class="fal mr-2 fa-link"></i>{% trans "Access" %}</a>
                        {% else %}
                            <a class="btn btn-xs w-100 btn-info" href={{ Request.link }} target="_blank"><i
                                    class="fal mr-2 fa-link"></i>{% trans "Access" %}</a>
                        {% endif %}
                    </td>
                    <td>{{ Request.create_date }}</td>
                    {% if Request.review_tag == "Accepted" %}
                        <td><i class="fal mr-2 fa-check"></i>{{ Request.review_tag }}</td>
                    {% elif Request.review_tag == "Rejected" %}
                        <td><i class="fal mr-2 fa-times"></i> {{ Request.review_tag }}</td>
                    {% else %}
                        <td><i class="fal mr-2 fa-question "></i> {{ Request.review_tag }}</td>
                    {% endif %}

                    {% if Request.review_tag == "To Review" %}
                        <td>{% trans "Not available yet" %}</td>
                    {% else %}
                        <td>
                            <a>
                                <button class="btn btn-xs btn-secondary w-100" type="button" data-toggle="modal"
                                        data-target="#myModal" data-id="{{ Request.comments }}"
                                        onClick="setComments();">
                                    {% trans "See Comments" %}
                                </button>
                            </a>
                        </td>
                    {% endif %}
                </tr>
            {% endfor %}
            </tbody>
        </table>

    {% fende_widget location='end' %}
    {% fende_widget widget_type='no-padding' location='start' id='VNFDstatus' title=_("VNFD status") %}
        <table id="tab2" class="table table-striped table-bordered">
            <thead>
            <tr>
                <th><i class="fal mr-2 fa-tags"></i> {% trans "VNF Name" %}</th>
                <th><i class="fal mr-2 fa-exclamation-circle"></i>{% trans "Version" %}</th>
                <th><i class="fal mr-2 fa-eye"></i>Link</th>
                <th><i class="fal mr-2 fa-calendar"></i>{% trans "Submission Date" %}</th>
                <th><i class="fal mr-2 fa-comment"></i>{% trans "Decision" %}</th>
                <th><i class="fal fa-fw fa-tasks"></i>{% trans "Actions" %}</th>
            </tr>
            </thead>
            <tbody>
            <!-- Populando a tabela com informações da tabela Requests -->
            {% for Request in vnfd_list %}
                <tr>
                    <td>{{ Request.VNF_name }}</td>
                    <td>{{ Request.version }}</td>
                    <td><a class="btn btn-xs w-100 btn-info" href={{ Request.link }} target="_blank"><i
                            class="fal mr-2 fa-link"></i>{% trans "Access" %}</a></td>
                    <td>{{ Request.create_date }}</td>
                    {% if Request.review_tag == "Accepted" %}
                        <td><i class="fal mr-2 fa-check "></i>{{ Request.review_tag }}</td>
                    {% elif Request.review_tag == "Rejected" %}
                        <td><i class="fal mr-2 fa-times "></i> {{ Request.review_tag }}</td>
                    {% else %}
                        <td><i class="fal mr-2 fa-question "></i> {{ Request.review_tag }}</td>
                    {% endif %}
                    {% if Request.review_tag == "To Review" %}
                        <td>{% trans "Not available yet" %}</td>
                    {% else %}
                        <td>
                            <button class="btn btn-xs btn-secondary w-100" type="button" data-toggle="modal"
                                    data-target="#myModal" data-id="{{ Request.comments }}"
                                    onClick="setComments();">{% trans "See Comments" %}</button>
                        </td>
                    {% endif %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% fende_widget location='end' %}

    <script>

        function setComments() {
            $('#myModal').on('show.bs.modal', function (e) {
                var myComments = $(e.relatedTarget).attr('data-id');
                $(e.currentTarget).find('textarea[name="comments"]').val(myComments);
            });
        }
    </script>


    <div id="myModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{% trans "Review Comments" %}</h5>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <textarea rows="10" class="w-100" maxlength="2000" name="comments"> </textarea>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


{% endblock %}

<!--SCRIPT TABELAS -->
{% block table %}
    {% fende_widget location='table' %}
{% endblock %}
<!--SCRIPT TABELAS -->
